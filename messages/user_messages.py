import json
import re
from typing import List

from aiogram.types import SuccessfulPayment
from asyncpg import Record

from config_reader import config
from sql import Database


class UserMessages:

    def __init__(self):
        self.not_active_event = '–ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–µ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ'
        self.reminder = ('üëã–í–æ–∑–º–æ–∂–Ω–æ –≤–∞—Å —á—Ç–æ-—Ç–æ –æ—Ç–≤–ª–µ–∫–ª–æ‚Ä¶\n\n'
                         '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è, –≤—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω–æ–µ, –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "‚ö°Ô∏è –ö—É–ø–∏—Ç—å" –∏ –∑–∞–±—Ä–æ–Ω–∏—Ä—É–π—Ç–µ –º–µ—Å—Ç–æ!\n\n'
                         '–ê –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –∫–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏—é –Ω–∞—à–µ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üìû –ó–∞–∫–∞–∑–∞—Ç—å –∑–≤–æ–Ω–æ–∫" üëá')
        self.ask_phone = ("‚ùáÔ∏è –ß—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ —Å –≤–∞–º–∏ —Å–≤—è–∑–∞—Ç—å—Å—è, –Ω–∞–∂–º–∏—Ç–µ 'üì≤ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–∞–∫—Ç'\n\n"
                          "‚ùó –ö–Ω–æ–ø–∫–∞ –ø–æ–¥ —Å—Ç—Ä–æ–∫–æ–π —Å–æ–æ–±—â–µ–Ω–∏–π\n"
                          "–ï—Å–ª–∏ –Ω–µ –≤–∏–¥–Ω–æ –∫–Ω–æ–ø–∫–∏, –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç–∏–∫ —Å —á–µ—Ç—ã—Ä—å–º—è —Ç–æ—á–∫–∞–º–∏, —Å–ø—Ä–∞–≤–∞ –æ—Ç —Å—Ç—Ä–æ–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π.")
        self.successful_contact = '‚òÄÔ∏è –°–ø–∞—Å–∏–±–æ! –í –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è –º—ã –≤–∞–º –ø–æ–∑–≤–æ–Ω–∏–º!'

    @staticmethod
    def event_description(description: str) -> str:
        formatted_description = (
            description.replace('<br>', '').replace('&nbsp;', '')
            .replace('–î–∞—Ç–∞', 'üóì –î–∞—Ç–∞').replace('–í—Ä–µ–º—è', 'üï∞ –í—Ä–µ–º—è')
            .replace('–°—Ç–æ–∏–º–æ—Å—Ç—å', 'üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å').replace('–õ–æ–∫–∞—Ü–∏—è', 'üìç –õ–æ–∫–∞—Ü–∏—è')
            .replace('–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', 'üï∞ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å')
        )
        pattern = r"(–õ–æ–∫–∞—Ü–∏—è:)(.*?)(\s)(https://.+)"
        formatted_text = re.sub(pattern, r'\1<a href="\4">\2</a>', formatted_description)
        return formatted_text

    @staticmethod
    def buttons_stat(buttons_data: List[Record]) -> str:
        if buttons_data:
            msg_usual = '[B]–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∫–Ω–æ–ø–∫–∞–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π[/B]\n\n'
            msg_buying = '[B]–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞–∂–∞—Ç–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ –∫–Ω–æ–ø–∫–∞–º –ø–æ–∫—É–ø–∫–∏[/B]\n\n'
            for record in buttons_data:
                if record.get('button_name').find('–ö—É–ø–∏—Ç—å') == -1:
                    msg_usual += f'[I]{record.get("button_name")}[/I] ({record.get("count")})\n'
                else:
                    msg_buying += f'[I]{record.get("button_name")}[/I] ({record.get("count")})\n'
            return f'{msg_usual}\n{msg_buying}' if msg_buying.split('\n\n')[1] != '' else msg_usual
        return '[B]–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–∂–∏–º–∞–ª –Ω–∞ –∫–Ω–æ–ø–∫–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –≤ —á–∞—Ç-–±–æ—Ç–µ[/B]'

    @staticmethod
    def other_payment(deal_id: int, event_name: str, product_price: float, method: str) -> str:
        order_part = ('–í–∞—à –∑–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω!\n\n'
                      '<b>–ü–æ–¥—Ä–æ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞:</b>\n'
                      f'<b>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞</b>: <code>{deal_id}</code>\n'
                      f'<b>–ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:</b>: <code>{event_name}</code>\n'
                      f'<b>–°—Ç–æ–∏–º–æ—Å—Ç—å</b>: <code>{product_price} PLN</code>\n\n')
        method_part = (f'‚ùì <b><u>–ö–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å</u></b>\n'
                       f'–û–ø–ª–∞—Ç–∏—Ç—å —Å –ø–æ–º–æ—â—å—é BLIK –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º (–Ω–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å):\n\n'
                       f'‚òéÔ∏è –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞: <code>690265990</code>\n'
                       f'üë§ –ü–æ–ª—É—á–∞—Ç–µ–ª—å: <code>Rudneva Volha</code>\n'
                       f'‚öôÔ∏è –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞: <code>{deal_id}</code>\n\n') \
            if method == 'blik' else \
            (f'‚ùì <b><u>–ö–∞–∫ –æ–ø–ª–∞—Ç–∏—Ç—å</u></b>\n'
             f'–û–ø–ª–∞—Ç–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –ø–µ—Ä–µ–≤–æ–¥–∞ –Ω–∞ –±–∞–Ω–∫–æ–≤—Å–∫–∏–π —Å—á—ë—Ç –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ —Ä–µ–∫–≤–∏–∑–∏—Ç–∞–º (–Ω–∞–∂–º–∏—Ç–µ, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å):\n\n'
             f'#Ô∏è‚É£ –ù–æ–º–µ—Ä —Å—á–µ—Ç–∞: <code>93 1090 2486 0000 0001 4922 9086</code>\n'
             f'üë§ –ü–æ–ª—É—á–∞—Ç–µ–ª—å: <code>Rudneva Volha</code>\n'
             f'‚öôÔ∏è –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞: <code>{deal_id}</code>\n\n')
        information_part = (f'‚ÄºÔ∏è –í–Ω–∏–º–∞–Ω–∏–µ ‚ÄºÔ∏è –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–æ! '
                            f'–ò–Ω–∞—á–µ –º—ã <u>–Ω–µ —Å–º–æ–∂–µ–º –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –í–∞—à –ø–ª–∞—Ç–µ–∂!</u>\n\n'
                            f'–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π —Å—Ä–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–∞ 24 —á–∞—Å–∞, –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ - '
                            f'–í–∞–º –ø—Ä–∏–¥–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ—Ç –±–æ—Ç–∞.\n–î–æ –≤—Å—Ç—Ä–µ—á–∏ –Ω–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–∏!')
        return f'{order_part}{method_part}{information_part}'

    @staticmethod
    def successful_payment(payment_data: SuccessfulPayment, product_name: str) -> str:
        currency = payment_data.currency
        total_amount = payment_data.total_amount
        deal_id = int(payment_data.invoice_payload.split(':')[1])
        provider_payment_charge_id = payment_data.provider_payment_charge_id
        return ('–°–ø–∞—Å–∏–±–æ –∑–∞ –æ–ø–ª–∞—Ç—É!\n\n'
                '<b>–ü–æ–¥—Ä–æ–±–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞—à–µ–≥–æ –∑–∞–∫–∞–∑–∞:</b>\n'
                f'<b>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞</b>: <code>{deal_id}</code>\n'
                f'<b>–ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è:</b>: <code>{product_name}</code>\n'
                f'<b>–°—Ç–æ–∏–º–æ—Å—Ç—å</b>: <code>{total_amount / 100} {currency}</code>\n'
                f'<b>–£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID –ø–ª–∞—Ç–µ–∂–∞:</b>: <code>{provider_payment_charge_id}</code>\n')

    @staticmethod
    def custom_send() -> str:
        return ("19.10 —á–µ—Ç–≤–µ—Ä–≥ –≤ 18.00\n\n"
                "<b>–ë–∏–∑–Ω–µ—Å - —É–∂–∏–Ω</b>\n\n"
                "–ö–ª–∞—Å—Å–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è, –æ–∫—Ä—É–∂–µ–Ω–∏–µ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π –∏–∑ –í—Ä–æ—Ü–ª–∞–≤–∞, –Ω–æ–≤—ã–µ –∫–æ–Ω—Ç–∞–∫—Ç—ã –∏ —Ä–µ—à–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å - –∑–∞–ø—Ä–æ—Å–æ–≤\n\n"
                "–¢–µ–º—ã –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è:\n\n"
                "- —Ä–∞–∑–≤–∏—Ç–∏–µ –æ—Ñ—Ñ–ª–∞–π–Ω –±–∏–∑–Ω–µ—Å–∞;\n"
                "- –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è –∏ –Ω–∞–ª–æ–≥–∏;\n"
                "- –º–∞—Ä–∫–µ—Ç–∏–Ω–≥ –∏ –ø—Ä–æ–¥–≤–∏–∂–µ–Ω–∏–µ;\n"
                "- –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ;\n"
                "- –ø–æ–¥–±–æ—Ä —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–≤ –∏ –ø–æ–¥—Ä—è–¥—á–∏–∫–æ–≤;\n"
                "- –ø—Ä–æ–¥–∞–∂–∏ –∏ –ø—Ä–∏–≤–ª–µ—á–µ–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–æ–≤;\n"
                "- –≤—ã—Ö–æ–¥ –Ω–∞ –∑–∞—Ä—É–±–µ–∂–Ω—ã–π —Ä—ã–Ω–æ–∫.\n\n"
                "üï∞ –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: 2-2,5 —á–∞—Å–∞\n"
                "üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å: 50 –∑–ª\n"
                'üìç –õ–æ–∫–∞—Ü–∏—è: <a href="https://maps.app.goo.gl/q9pjcudCcBnvcHts5">Ristorante Pizzeria O Sole Mio, 16/17, Rynek, Wroc≈Çaw</a>')

    @staticmethod
    async def cabinet(user_id: int) -> str:
        async with Database() as db:
            user_data: List[Record] = await db.get_user_data(user_id)
            user_city = user_data[0].get('city')

        return ('–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –í–∞—à –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç!\n\n'
                '–ó–¥–µ—Å—å –í—ã –º–æ–∂–µ—Ç–µ –ª–µ–≥–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–≤–æ–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –í–∞—à–∏—Ö –∑–∞–∫–∞–∑–æ–≤.\n\n'
                '–í —Ä–∞–∑–¥–µ–ª–µ "üìö –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤" –í—ã —Å–º–æ–∂–µ—Ç–µ –æ–∫—É–Ω—É—Ç—å—Å—è –≤ –≤–æ—Å–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ –≤–∞—à–∏—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∑–∞–∫–∞–∑–∞—Ö. '
                '–¢–∞–º –í—ã –Ω–∞–π–¥–µ—Ç–µ –≤—Å–µ –¥–µ—Ç–∞–ª–∏ –æ —Ç–µ—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö, –∫–æ—Ç–æ—Ä—ã–µ –í—ã –ø–æ—Å–µ—â–∞–ª–∏, –≤–∫–ª—é—á–∞—è –¥–∞—Ç—ã –∏ –¥—Ä—É–≥—É—é –∏–Ω—Ç–µ—Ä–µ—Å–Ω—É—é '
                '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é.\n\n'
                '–í —Ä–∞–∑–¥–µ–ª–µ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏" –í—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ–π —Ç–µ–∫—É—â–∏–π –≥–æ—Ä–æ–¥.\n\n'
                f'–í –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –í–∞—à –≥–æ—Ä–æ–¥ - üü¢ <b>{user_city}</b>.\n\n'
                f'–ß—Ç–æ–±—ã –≤–∏–¥–µ—Ç—å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –≤ –¥—Ä—É–≥–æ–º –≥–æ—Ä–æ–¥–µ, –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å–≤–æ–π –ª—é–±–∏–º—ã–π –≥–æ—Ä–æ–¥.\n\n'
                f'–î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã –≤—ã–±–µ—Ä–∏—Ç–µ –æ–¥–Ω—É –∏–∑ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–ø—Ü–∏–π –Ω–∏–∂–µ üëá')

    @staticmethod
    async def settings(user_id: int) -> str:
        async with Database() as db:
            user_data: List[Record] = await db.get_user_data(user_id)
            user_city = user_data[0].get('city')

        return ('–í–∞—à–∏ —Ç–µ–∫—É—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:\n\n'
                f'–í–∞—à –≥–æ—Ä–æ–¥ - üü¢ <b>{user_city}</b>\n\n'
                f'<b>–í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –≤—ã –º–æ–∂–µ—Ç–µ:</b>\n\n'
                f'"üåÜ –ò–∑–º–µ–Ω–∏—Ç—å –≥–æ—Ä–æ–¥"\n'
                f'<i>- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ–±–Ω–æ–≤–ª—è—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é, –º—ã –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ–º –í–∞–º –¥–æ—Å—Ç—É–ø –∫ —Å–∞–º—ã–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–º –º–∞—Å—Ç–µ—Ä-–∫–ª–∞—Å—Å–∞–º, '
                f'–Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥–∞–º, –±–∏–∑–Ω–µ—Å —É–∂–∏–Ω–∞–º –∏ –¥—Ä—É–≥–∏–º –≤–∞–∂–Ω—ã–º —Å–æ–±—ã—Ç–∏—è–º, —Å–ø–æ—Å–æ–±–Ω—ã–º —Ä–∞—Å—à–∏—Ä–∏—Ç—å –≤–∞—à–µ –¥–µ–ª–æ–≤–æ–µ –æ–±—â–µ–Ω–∏–µ –∏ '
                f'–ø–æ–º–æ—á—å –≤–∞–º –¥–æ—Å—Ç–∏—á—å —É—Å–ø–µ—Ö–∞ –≤ –í–∞—à–µ–º –≥–æ—Ä–æ–¥–µ. <code>üìÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å–æ–±—ã—Ç–∏–π</code> –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç –í–∞–º '
                f'—Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å–æ–≥–ª–∞—Å–Ω–æ –≤—ã–±—Ä–∞–Ω–Ω–æ–º—É –≥–æ—Ä–æ–¥—É.</i>')

    @staticmethod
    async def change_city(user_id: int) -> str:
        async with Database() as db:
            user_data: List[Record] = await db.get_user_data(user_id)
            user_city = user_data[0].get('city')

        return (f'–ì–æ—Ä–æ–¥, –≤ –∫–æ—Ç–æ—Ä–æ–º –º—ã –ø—Ä–æ–≤–æ–¥–∏–º –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –¥–ª—è –í–∞—Å:\n\n'
                f'üü¢ <b>{user_city}</b>\n\n'
                '–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–∞–∑–≤–∞–Ω–∏–∏ –≥–æ—Ä–æ–¥–∞, —á—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å üëá')

    @staticmethod
    def about_us() -> str:
        return ('üåü –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ InsightClub üåü\n\n'
                'üåç –ú—ã –æ—Ä–≥–∞–Ω–∏–∑—É–µ–º –Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥-—Å–æ–±—ã—Ç–∏—è, –±–∏–∑–Ω–µ—Å-—É–∂–∏–Ω—ã –∏ –º–∞—Å—Ç–µ—Ä–º–∞–π–Ω–¥—ã –≤ –≥–æ—Ä–æ–¥–∞—Ö –ü–æ–ª—å—à–∏ –¥–ª—è –≤–∞—à–µ–≥–æ —Ä–æ—Å—Ç–∞ –∏ '
                '–º–æ—Ç–∏–≤–∞—Ü–∏–∏.\n\n'
                'üíº –ù–∞—à–∞ –º–∏—Å—Å–∏—è - —Å–æ–µ–¥–∏–Ω—è—Ç—å –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π, –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤ –∏ —Ç–≤–æ—Ä—á–µ—Å–∫–∏—Ö –ª—é–¥–µ–π, —Å–æ–∑–¥–∞–≤–∞—è —Ü–µ–Ω–Ω—ã–µ —Å–≤—è–∑–∏ '
                '–∏ –æ—Ç–∫—Ä—ã–≤–∞—è –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏.\n\n'
                'üéâ –ù–∞—à–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è - —ç—Ç–æ –∏—Å—Ç–æ—á–Ω–∏–∫ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏—è, –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ —Å–æ—Ç—Ä—É–¥–Ω–∏—á–µ—Å—Ç–≤–∞!\n\n'
                'ü§ù –ü—Ä–∏—Ö–æ–¥–∏—Ç–µ, –Ω–∞—Ö–æ–¥–∏—Ç–µ –Ω–æ–≤—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤, –∑–Ω–∞–∫–æ–º—å—Ç–µ—Å—å –≤ –∞—Ç–º–æ—Å—Ñ–µ—Ä–µ –∫–ª–∞—Å—Å–Ω–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è.\n\n'
                'üíå –ò–∑—É—á–∏—Ç–µ —Ä–∞–∑–¥–µ–ª—ã "üóì –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ" –∏ "üëë –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏", —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å –±–æ–ª—å—à–µ –æ –Ω–∞—à–∏—Ö '
                '—Å–æ–±—ã—Ç–∏—è—Ö –∏ –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ —Å–µ—Ç–∏ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª–æ–≤ –∏ –ø—Ä–µ–¥–ø—Ä–∏–Ω–∏–º–∞—Ç–µ–ª–µ–π!')

    @staticmethod
    async def personal_selection(user_id: int) -> str:
        async with Database() as db:
            user_data: List[Record] = await db.get_user_data(user_id)
            user_city = user_data[0].get('city')

        return ('üîç <b>–í–∞—à–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</b> üîç\n\n'
                f'–ú—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—É—é –∞–Ω–∫–µ—Ç—É –∏ —É—á–ª–∏ –≤—Å–µ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è, —á—Ç–æ–±—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ '
                f'—Å–æ–±—ã—Ç–∏—è.\n'
                f'–°—Ç—Ä–µ–º–∏–º—Å—è —Å–¥–µ–ª–∞—Ç—å –≤–∞—à–µ —É—á–∞—Å—Ç–∏–µ –≤ <b>InsightClub</b> –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –Ω–µ–∑–∞–±—ã–≤–∞–µ–º—ã–º –∏ –≤–¥–æ—Ö–Ω–æ–≤–ª—è—é—â–∏–º –Ω–∞ '
                f'–Ω–æ–≤—ã–µ –∏–¥–µ–∏üí°‚ú®\n\n'
                f'–ü—Ä–µ–¥–ª–∞–≥–∞–µ–º –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –≤ –≥–æ—Ä–æ–¥–µ üü¢ <b>{user_city}</b>, –∫–æ—Ç–æ—Ä—ã–µ –∏–¥–µ–∞–ª—å–Ω–æ '
                f'—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç –≤–∞—à–µ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏ –∏–Ω—Ç–µ—Ä–µ—Å–∞–ºüëá\n\n'
                f'<i>–í—ã –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Å–≤–æ–π –≥–æ—Ä–æ–¥ –∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –≤ —Ä–∞–∑–¥–µ–ª–µ:\n'
                '"‚≠êÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é" ‚û°Ô∏è "üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç" ‚û°Ô∏è "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏"</i>')

    @staticmethod
    def personal_selection_anketa() -> str:
        return ('üîç <b>–í–∞—à–∏ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</b> üîç\n\n'
                '–ß—Ç–æ–±—ã –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –≤–∞–º –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, –Ω–∞–º –Ω—É–∂–Ω–æ —É–∑–Ω–∞—Ç—å –Ω–µ–º–Ω–æ–≥–æ –±–æ–ª—å—à–µ –æ –≤–∞—à–∏—Ö '
                '–ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è—Ö.\n'
                '–ü—Ä–æ–π–¥–∏—Ç–µ –Ω–µ–±–æ–ª—å—à—É—é –∞–Ω–∫–µ—Ç—É –∏–∑ —Ç—Ä–µ—Ö –≤–æ–ø—Ä–æ—Å–æ–≤, –∏ –º—ã –ø–æ–¥–±–µ—Ä–µ–º –¥–ª—è –≤–∞—Å —Ç–æ, —á—Ç–æ –±—É–¥–µ—Ç –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã–º –∏ –ø–æ–ª–µ–∑–Ω—ã–º! '
                'üéâüåü\n\n'
                '–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "üîñ –ù–∞—á–∞—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã" üëá')

    @staticmethod
    def anketa_step_1() -> str:
        return ('‚ùì <b>–£–∫–∞–∂–∏—Ç–µ –≤–∞—à –≤–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</b>\n\n'
                '<i>–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üì® –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"</i>')

    @staticmethod
    def anketa_step_2() -> str:
        return ('‚ùì <b>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—ã –∫–æ—Ç–æ—Ä—ã–µ –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã</b>\n\n'
                '<i>–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üì® –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"</i>')

    @staticmethod
    def anketa_step_3() -> str:
        return ('‚ùì <b>–£–∫–∞–∂–∏—Ç–µ —á—Ç–æ –≤—ã –ø—Ä–æ–¥–∞–µ—Ç–µ</b>\n\n'
                '<i>–í—ã–±–µ—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üì® –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å"</i>')

    @staticmethod
    async def end_of_anketa(user_id: int) -> str:
        products_custom_property_lvl2 = json.loads(config.products_custom_property_lvl2.get_secret_value())
        async with Database() as db:
            user_data: List[Record] = await db.get_user_data(user_id)
        user_activities_list = user_data[0].get('activities').split(',')
        products_activities_list = products_custom_property_lvl2.get('property102')
        user_topics_list = user_data[0].get('topics').split(',')
        products_topics_list = products_custom_property_lvl2.get('property104')
        user_sales_types_list = user_data[0].get('sales_types').split(',')
        products_sales_types_list = products_custom_property_lvl2.get('property106')

        user_activities_str = ', '.join(product_property['valueEnum'] for product_property in products_activities_list
                                        if product_property['value'] in user_activities_list)
        user_topics_str = ', '.join(product_property['valueEnum'] for product_property in products_topics_list
                                    if product_property['value'] in user_topics_list)
        user_sales_types_str = ', '.join(product_property['valueEnum'] for product_property in products_sales_types_list
                                         if product_property['value'] in user_sales_types_list)

        return ('üôå –ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –≤–∞—Å –∑–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –∞–Ω–∫–µ—Ç—ã! üìù \n\n'
                '<b>–í–∞—à–∏ –æ—Ç–≤–µ—Ç—ã:</b>\n\n'
                f'<b>1. –í–∏–¥ –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:</b> {user_activities_str}\n'
                f'<b>2. –ò–Ω—Ç–µ—Ä–µ—Å—É—é—â–∏–µ —Ç–µ–º—ã:</b> {user_topics_str}\n'
                f'<b>3. –ß—Ç–æ –≤—ã –ø—Ä–æ–¥–∞–µ—Ç–µ:</b> {user_sales_types_str}\n\n'
                '–í–∞—à–∏ –æ—Ç–≤–µ—Ç—ã –ø–æ–º–æ–≥—É—Ç –Ω–∞–º –ª—É—á—à–µ –ø–æ–Ω—è—Ç—å –≤–∞—à–∏ –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è –∏ –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ '
                '–º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è. üíºüåü\n\n'
                '–¢–µ–ø–µ—Ä—å –Ω–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É "üëë –ú–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è –¥–ª—è –º–µ–Ω—è" –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —É –Ω–∞—Å –¥–ª—è –≤–∞—Å –µ—Å—Ç—å! üëá')

    @staticmethod
    def main_menu() -> str:
        return ('–ü—Ä–∏–≤–µ—Ç!üëã –Ø –±–æ—Ç –∫–æ–º–ø–∞–Ω–∏–∏ InsightClub, —ç–∫—Å–ø–µ—Ä—Ç–∞ –≤ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –±–∏–∑–Ω–µ—Å –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π, –±–∏–∑–Ω–µ—Å —É–∂–∏–Ω–æ–≤, '
                '–Ω–µ—Ç–≤–æ—Ä–∫–∏–Ω–≥–æ–≤ –∏ –¥—Ä—É–≥–∏—Ö –∏–Ω—Ç–µ—Ä–µ—Å–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π.\n\n'
                '–í–æ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –≤ –º–µ–Ω—é:\n\n'
                '"üóì –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ" - —É–∑–Ω–∞–π—Ç–µ –æ –≤—Å–µ—Ö –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–º –≥–æ—Ä–æ–¥–µ. –ó–∞–±—Ä–æ–Ω–∏—Ä—É–π—Ç–µ –∏ –æ–ø–ª–∞—Ç–∏—Ç–µ '
                '—É—á–∞—Å—Ç–∏–µ –ª—é–±—ã–º —É–¥–æ–±–Ω—ã–º –¥–ª—è –≤–∞—Å —Å–ø–æ—Å–æ–±–æ–º.\n\n'
                '"üéâ –û –Ω–∞—Å" - —É–∑–Ω–∞–π—Ç–µ –±–æ–ª—å—à–µ –æ –Ω–∞—à–µ–π –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –Ω–∞—à–∏—Ö —Ü–µ–Ω–Ω–æ—Å—Ç—è—Ö.\n\n'
                '"üëë –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏" - –ø–æ–ª—É—á–∞–π—Ç–µ –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è –æ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏—è—Ö, '
                '—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –≤–∞—à–∏–º –ª–∏—á–Ω—ã–º –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏—è–º.\n\n'
                '"üë§ –õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç" - —É–ø—Ä–∞–≤–ª—è–π—Ç–µ —Å–≤–æ–∏–º –ø—Ä–æ—Ñ–∏–ª–µ–º. –í –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ "üìö –ò—Å—Ç–æ—Ä–∏—è –∑–∞–∫–∞–∑–æ–≤" –≤—ã –Ω–∞–π–¥–µ—Ç–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ '
                '–≤–∞—à–∏—Ö –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö (<i>*—Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ</i>), –∞ –≤ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ "‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏" –≤—ã —Å–º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –≥–æ—Ä–æ–¥ –¥–ª—è –ø–æ–∏—Å–∫–∞ –º–µ—Ä–æ–ø—Ä–∏—è—Ç–∏–π –∏ '
                '–ø–µ—Ä–µ–ø—Ä–æ–π—Ç–∏ –∞–Ω–∫–µ—Ç—É –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π.\n\n'
                '"‚ùì –ó–∞–¥–∞—Ç—å –≤–æ–ø—Ä–æ—Å" - –∑–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–º –∫–æ–º–ø–∞–Ω–∏–∏ –∏ –∑–∞–¥–∞—Ç—å –ª—é–±—ã–µ –≤–æ–ø—Ä–æ—Å—ã, '
                '–∫–æ—Ç–æ—Ä—ã–µ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ (<i>*—Å–∫–æ—Ä–æ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ</i>).')
